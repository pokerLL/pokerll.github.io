(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{360:function(t,s,n){"use strict";n.r(s);var a=n(14),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ctypes-c语言交互"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctypes-c语言交互"}},[t._v("#")]),t._v(" ctypes-C语言交互")]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[t._v("​"),s("code",[t._v("ctypes")]),t._v("​是Python的一个标准库，用于与C语言进行交互。它提供了一种简单的方式来调用动态链接库（DLL）或共享库中的C函数，并在Python中使用这些函数。")]),t._v(" "),s("p",[t._v("以下是"),s("code",[t._v("ctypes")]),t._v("​库的一些主要特点：")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("跨平台性")]),t._v("："),s("code",[t._v("ctypes")]),t._v("​库可以在多个操作系统上工作，包括Windows、Linux和macOS等。")]),t._v(" "),s("li",[s("strong",[t._v("无需编写C扩展模块")]),t._v("：传统的Python C扩展模块需要通过编写C代码来实现与C语言的交互。而使用"),s("code",[t._v("ctypes")]),t._v("​，你无需编写C扩展模块，只需使用Python本身即可与C函数进行交互。")]),t._v(" "),s("li",[s("strong",[t._v("自动处理数据类型转换")]),t._v("："),s("code",[t._v("ctypes")]),t._v("​会根据函数的参数类型自动进行数据类型转换，使得Python对象和C函数之间的交互更加方便和灵活。")]),t._v(" "),s("li",[s("strong",[t._v("支持指针操作")]),t._v("："),s("code",[t._v("ctypes")]),t._v("​提供了对指针的支持，可以使用"),s("code",[t._v("POINTER")]),t._v("​类型来操作内存中的数据。")]),t._v(" "),s("li",[s("strong",[t._v("直接访问DLL函数")]),t._v("：使用"),s("code",[t._v("ctypes")]),t._v("​，你可以直接访问动态链接库中的函数，而不需要额外的中间层。")])]),t._v(" "),s("p",[t._v("‍")]),t._v(" "),s("h2",{attrs:{id:"示例-自动移动鼠标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-自动移动鼠标"}},[t._v("#")]),t._v(" 示例 - 自动移动鼠标")]),t._v(" "),s("p",[t._v("主要场景是一些客户的电脑几分钟不动就自动锁屏，再次打开需要输入密码，比较繁琐，使用这个脚本可以自动移动鼠标防止电脑锁屏。并且使用的是"),s("code",[t._v("ctypes")]),t._v("​这个库也不用额外安装依赖。")]),t._v(" "),s("blockquote",[s("p",[t._v("emmm 在中信实测无效")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ctypes\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" random\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置移动鼠标的间隔时间（单位：秒）")]),t._v("\ninterval "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取屏幕的宽度和高度")]),t._v("\nuser32 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctypes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("windll"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user32\nscreen_width"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" screen_height "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetSystemMetrics"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetSystemMetrics"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成一个随机的坐标位置")]),t._v("\n        x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" screen_width"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        y "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" screen_height"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 移动鼠标到指定位置")]),t._v("\n        user32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetCursorPos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 等待一定时间")]),t._v("\n        time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("interval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" KeyboardInterrupt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"脚本已停止"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);