(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{559:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"花式导包的八种方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#花式导包的八种方法"}},[t._v("#")]),t._v(" 花式导包的八种方法")]),t._v(" "),a("h2",{attrs:{id:"直接-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#直接-import"}},[t._v("#")]),t._v(" 直接 import")]),t._v(" "),a("p",[t._v("人尽皆知的方法，直接导入即可")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("p",[t._v("与此类似的还有，不再细讲")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("一般情况下，使用 ​"),a("code",[t._v("import")]),t._v("​语句导入模块已经够用的。")]),t._v(" "),a("p",[t._v("但是在一些特殊场景中，可能还需要其他的导入方式。")]),t._v(" "),a("p",[t._v("下面我会一一地给你介绍。")]),t._v(" "),a("p",[t._v("‍")]),t._v(" "),a("h2",{attrs:{id:"使用-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-import"}},[t._v("#")]),t._v(" 使用 __import__")]),t._v(" "),a("p",[t._v("​"),a("code",[t._v("__import__")]),t._v("​函数可用于导入模块，import 语句也会调用函数。其定义为：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("__import__(name[, globals[, locals[, fromlist[, level]]]])\n")])])]),a("p",[t._v("参数介绍：")]),t._v(" "),a("ul",[a("li",[t._v("name (required): 被加载 module 的名称")]),t._v(" "),a("li",[t._v("globals (optional): 包含全局变量的字典，该选项很少使用，采用默认值 global()")]),t._v(" "),a("li",[t._v("locals (optional): 包含局部变量的字典，内部标准实现未用到该变量，采用默认值 - local()")]),t._v(" "),a("li",[t._v("fromlist (Optional): 被导入的 submodule 名称")]),t._v(" "),a("li",[t._v("level (Optional): 导入路径选项，Python 2 中默认为 -1，表示同时支持 absolute import 和 relative import。Python 3 中默认为 0，表示仅支持 absolute import。如果大于 0，则表示相对导入的父目录的级数，即 1 类似于 ‘.’，2 类似于 ‘..’。")])]),t._v(" "),a("p",[t._v("使用示例如下：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" os "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("__import__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'os'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("p",[t._v("如果要实现 "),a("code",[t._v("import xx as yy")]),t._v("​ 的效果，只要修改左值即可")]),t._v(" "),a("p",[t._v("如下示例，等价于 "),a("code",[t._v("import os as myos")]),t._v("​：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("__import__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'os'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("p",[t._v("上面说过的 "),a("code",[t._v("__import__")]),t._v("​ 是一个内建函数，既然是内建函数的话，那么这个内建函数必将存在于 "),a("code",[t._v("__buildins__")]),t._v("​ 中，因此我们还可以这样导入 os 的模块：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" __builtins__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__dict__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__import__'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'os'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("h2",{attrs:{id:"使用-importlib-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-importlib-模块"}},[t._v("#")]),t._v(" 使用 importlib 模块")]),t._v(" "),a("p",[t._v("importlib 是 Python 中的一个标准库，importlib 能提供的功能非常全面。")]),t._v(" "),a("p",[t._v("它的简单示例：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" importlib\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("importlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("import_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"os"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("p",[t._v("如果要实现 "),a("code",[t._v("import xx as yy")]),t._v("​效果，可以这样")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" importlib\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" importlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("import_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"os"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("h2",{attrs:{id:"使用-imp-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-imp-模块"}},[t._v("#")]),t._v(" 使用 imp 模块")]),t._v(" "),a("p",[t._v("​"),a("code",[t._v("imp")]),t._v("​ 模块提供了一些 import 语句内部实现的接口。例如模块查找（find_module）、模块加载（load_module）等等（模块的导入过程会包含模块查找、加载、缓存等步骤）。可以用该模块来简单实现内建的 "),a("code",[t._v("__import__")]),t._v("​ 函数功能：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" imp\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" desc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'os'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" imp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sep'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" desc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("module "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sep'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/usr/lib64/python2.7/os.pyc'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" myos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("p",[t._v("从 python 3 开始，内建的 reload 函数被移到了 imp 模块中。而从 Python 3.4 开始，imp 模块被否决，不再建议使用，其包含的功能被移到了 importlib 模块下。即从 Python 3.4 开始，importlib 模块是之前 imp 模块和 importlib 模块的合集。")]),t._v(" "),a("h2",{attrs:{id:"使用-execfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-execfile"}},[t._v("#")]),t._v(" 使用 execfile")]),t._v(" "),a("p",[t._v("在 Python 2 中有一个 execfile 函数，利用它可以用来执行一个文件。")]),t._v(" "),a("p",[t._v("语法如下：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("execfile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("globals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("locals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("参数有这么几个：")]),t._v(" "),a("ul",[a("li",[t._v("filename：文件名。")]),t._v(" "),a("li",[t._v("globals：变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。")]),t._v(" "),a("li",[t._v("locals：变量作用域，局部命名空间，如果被提供，可以是任何映射对象。")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(">>> execfile(\"/usr/lib64/python2.7/os.py\")\n>>>\n>>> getcwd()\n'/home/wangbm'\n")])])]),a("h2",{attrs:{id:"使用-exec-执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-exec-执行"}},[t._v("#")]),t._v(" 使用 exec 执行")]),t._v(" "),a("p",[t._v("​"),a("code",[t._v('<span class="pre">execfile</span>')]),t._v("​ 只能在 Python2 中使用，Python 3.x 里已经删除了这个函数。")]),t._v(" "),a("p",[t._v("但是原理值得借鉴，你可以使用 open … read 读取文件内容，然后再用 exec 去执行模块。")]),t._v(" "),a("p",[t._v("示例如下：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/lib64/python2.7/os.py"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" getcwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/wangbm'")]),t._v("\n")])])]),a("h2",{attrs:{id:"import-from-github-com"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#import-from-github-com"}},[t._v("#")]),t._v(" import_from_github_com")]),t._v(" "),a("p",[t._v("有一个包叫做 ​"),a("strong",[t._v("import_from_github_com")]),t._v("​，从名字上很容易得知，它是一个可以从 github 下载安装并导入的包。为了使用它，你需要做的就是按照如下命令使用pip 先安装它。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("$ python3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m pip install import_from_github_com\n")])])]),a("p",[t._v("这个包使用了PEP 302中新的引入钩子，允许你可以从github上引入包。这个包实际做的就是安装这个包并将它添加到本地。你需要 Python 3.2 或者更高的版本，并且 git 和 pip 都已经安装才能使用这个包。")]),t._v(" "),a("p",[t._v("pip 要保证是较新版本，如果不是请执行如下命令进行升级。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ python3 -m pip install --upgrade pip\n")])])]),a("p",[t._v("确保环境 ok 后，你就可以在 Python shell 中使用 import_from_github_com")]),t._v(" "),a("p",[t._v("示例如下")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(">>> from github_com.zzzeek import sqlalchemy\nCollecting git+https://github.com/zzzeek/sqlalchemy\nCloning https://github.com/zzzeek/sqlalchemy to /tmp/pip-acfv7t06-build\nInstalling collected packages: SQLAlchemy\nRunning setup.py install for SQLAlchemy ... done\nSuccessfully installed SQLAlchemy-1.1.0b1.dev0\n>>> locals()\n{'__builtins__': <module 'builtins' (built-in)>, '__spec__': None,\n'__package__': None, '__doc__': None, '__name__': '__main__',\n'sqlalchemy': <module 'sqlalchemy' from '/usr/local/lib/python3.5/site-packages/\\\nsqlalchemy/__init__.py'>,\n'__loader__': <class '_frozen_importlib.BuiltinImporter'>}\n>>>\n")])])]),a("p",[t._v("看了 import_from_github_com的源码后，你会注意到它并没有使用importlib。实际上，它的原理就是使用 pip 来安装那些没有安装的包，然后使用Python的"),a("code",[t._v("__import__()")]),t._v("​函数来引入新安装的模块。")]),t._v(" "),a("h2",{attrs:{id:"远程导入模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程导入模块"}},[t._v("#")]),t._v(" 远程导入模块")]),t._v(" "),a("p",[t._v("我在这篇文章里（"),a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzIzMzMzOTI3Nw==&mid=2247484838&idx=1&sn=1e6fbf5d7546902c6965c60383f7b639&chksm=e8866544dff1ec52e01b6c9a982dfa150b8e34ad472acca35201373dc51dadb5a8630870982a&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入探讨 Python 的 import 机制：实现远程导入模块"),a("OutboundLink")],1),t._v("），深入剖析了导入模块的内部原理，并在最后手动实现了从远程服务器上读取模块内容，并在本地成功将模块导入的导入器。")]),t._v(" "),a("p",[t._v("具体内容非常的多，你可以点击这个"),a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzIzMzMzOTI3Nw==&mid=2247484838&idx=1&sn=1e6fbf5d7546902c6965c60383f7b639&chksm=e8866544dff1ec52e01b6c9a982dfa150b8e34ad472acca35201373dc51dadb5a8630870982a&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("链接"),a("OutboundLink")],1),t._v("进行深入学习。")]),t._v(" "),a("p",[t._v("示例代码如下：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 新建一个 py 文件（my_importer.py），内容如下\nimport sys\nimport importlib\nimport urllib.request as urllib2\n\nclass UrlMetaFinder(importlib.abc.MetaPathFinder):\n    def __init__(self, baseurl):\n        self._baseurl = baseurl\n\n\n    def find_module(self, fullname, path=None):\n        if path is None:\n            baseurl = self._baseurl\n        else:\n            # 不是原定义的url就直接返回不存在\n            if not path.startswith(self._baseurl):\n                return None\n            baseurl = path\n\n        try:\n            loader = UrlMetaLoader(baseurl)\n            return loader\n        except Exception:\n            return None\n\nclass UrlMetaLoader(importlib.abc.SourceLoader):\n    def __init__(self, baseurl):\n        self.baseurl = baseurl\n\n    def get_code(self, fullname):\n        f = urllib2.urlopen(self.get_filename(fullname))\n        return f.read()\n\n    def get_data(self):\n        pass\n\n    def get_filename(self, fullname):\n        return self.baseurl + fullname + '.py'\n\ndef install_meta(address):\n    finder = UrlMetaFinder(address)\n    sys.meta_path.append(finder)\n")])])]),a("p",[t._v("并且在远程服务器上开启 http 服务（为了方便，我仅在本地进行演示），并且手动编辑一个名为 my_info 的 python 文件，如果后面导入成功会打印 "),a("code",[t._v('<span class="pre">ok</span>')]),t._v("​。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ mkdir httpserver && cd httpserver\n$ cat>my_info.py<EOF\nname='wangbm'\nprint('ok')\nEOF\n$ cat my_info.py\nname='wangbm'\nprint('ok')\n$\n$ python3 -m http.server 12800\nServing HTTP on 0.0.0.0 port 12800 (http://0.0.0.0:12800/) ...\n...\n")])])]),a("p",[t._v("一切准备好，验证开始。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(">>> from my_importer import install_meta\n>>> install_meta('http://localhost:12800/') # 往 sys.meta_path 注册 finder\n>>> import my_info  # 打印ok，说明导入成功\nok\n>>> my_info.name  # 验证可以取得到变量\n'wangbm'\n")])])]),a("p",[t._v("好了，8 种方法都给大家介绍完毕，对于普通开发者来说，其实只要掌握 import 这种方法足够了，而对于那些想要自己开发框架的人来说，深入学习"),a("code",[t._v("__import__")]),t._v("​以及 importlib 是非常有必要的。")])])}),[],!1,null,null,null);a.default=e.exports}}]);